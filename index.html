<!DOCTYPE html>
<html>
	<head>
		<title>This is a vulnerable site</title>
		<style type="text/css">
			.hidden { display : none; }
		</style>
	</head>
	<body>
		<form action='.' method='GET'>
			<input type='text' placeholder='Search terms...' name='search-term' />
			<input type='submit' value='Search'>
		</form>
		<p class='hidden' id='search-desc'>
			You searched for : <span id='search-term'></span>
		</p>
		<div id='search-results'></div>
		<div id='branding'></div>
		<script type="text/javascript" src="https://www.google.com/jsapi"></script>
		<script type="text/javascript">
			google.load("search", "1");
			google.setOnLoadCallback(function () {
				var searchTerm = document.location.search.split('=')[1];
				if (searchTerm) {
					var imageSearch = new google.search.ImageSearch();
					document.getElementById('search-desc').classList.remove('hidden');
					// Yep, we're really having to work to create an easy to exploit XSS vulnerability here
					document.getElementById('search-term').innerHTML = decodeURIComponent(searchTerm);

					imageSearch.setSearchCompleteCallback(null, function () {
						imageSearch.results.forEach(function (result) {
							document.getElementById('search-results').appendChild(result.html.cloneNode(true));
						});
				        google.search.Search.getBranding('branding');
					});
					imageSearch.execute(searchTerm);
				}
			});
		</script>
	</body>
</html>